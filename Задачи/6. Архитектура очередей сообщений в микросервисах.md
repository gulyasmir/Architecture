### **6. Архитектура очередей сообщений в микросервисах**

**Задача:**
Требуется спроектировать систему, где микросервисы взаимодействуют асинхронно, чтобы избежать перегрузки.
**Решите:**

* Как выбрать брокер сообщений?
* Как обеспечить гарантированную доставку сообщений?
* Как избежать дублирования сообщений?

**Возможные решения:**

* Kafka или RabbitMQ для очередей
* Использование **Dead Letter Queue (DLQ)** для обработки ошибок
* Использование **idempotency key** для избежания дублирования


**Dead Letter Queue (DLQ)** – это специальная очередь сообщений в системах асинхронной обработки (например, RabbitMQ, AWS SQS, Kafka), куда попадают сообщения, которые не удалось обработать.

### Основные причины попадания в DLQ:

* Сообщение превышает максимальное число попыток обработки (retry).
* Ошибки в обработчике сообщений (например, исключения в коде).
* Несоответствие формата или структуры сообщения.
* Истечение времени жизни сообщения (TTL).

### Зачем нужна DLQ?

* Позволяет избежать бесконечных ретраев проблемных сообщений.
* Облегчает отладку, анализируя причины сбоев.
* Уменьшает влияние проблемных сообщений на основную очередь.

### Как работать с DLQ?

1. Настроить DLQ для целевой очереди.
2. Регулярно мониторить и анализировать сообщения в DLQ.
3. Разрабатывать стратегии повторной обработки или уведомления о сбоях.

Использование DLQ помогает повысить надежность и отказоустойчивость распределенных систем
